"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[823],{5170:function(e,t,s){s(7313);t.Z=s.p+"static/media/sendicon.959c9c9a24b95e47529320c7bbbdd93c.svg"},9823:function(e,t,s){s.r(t),s.d(t,{default:function(){return R}});var i=s(1413),a=s(5671),o=s(3144),n=s(136),c=s(7277),d=s(7313),l=s(7224),r=s(7185),h=s(6125),m=s(5034),u=s(5170),x=s(9864),f=s(8467),p=s(6446),g=s(3392),b=s(2549),v=s(1391),w=s(942),j=s(8933),y=s(6306),S=s(2658),Z=s(1577),M=s(4725);var k=s.p+"static/media/emojij.a0df3e98d05714551474a234c0e05ef6.svg",N=s(3936),C=s(4949),I=s(4319),B=s(9526),T=s(6417),q=function(e){(0,n.Z)(s,e);var t=(0,c.Z)(s);function s(e){var o;return(0,a.Z)(this,s),(o=t.call(this,e)).keyDown=function(e){"Enter"===e.code&&(e.preventDefault(),o.sendMessage())},o.requestMatch=function(){o.state.matchRequested?o.setState((0,i.Z)((0,i.Z)({},o.state),{},{alertMsg:"Processing match request",alertType:"info"})):(o.setState((0,i.Z)((0,i.Z)({},o.state),{},{matchRequested:!0})),o.state.Socket.emit("MatchRequest",{mode:"chat",name:o.props.authentication.name,age:o.props.authentication.age,gender:o.props.authentication.gender}))},o.revokeMatch=function(){o.state.isMatched?(o.state.Socket.emit("MatchRevoked",{recepientId:o.state.recepientId}),o.textList=[],window.sessionStorage.removeItem("recepientName"),window.sessionStorage.removeItem("recepientGender"),x.Z.dispatch((0,w.c4)())):o.setState((0,i.Z)((0,i.Z)({},o.state),{},{alertMsg:"You're not connected",alertType:"warning"}))},o.sendMessage=function(){o.state.message.length>0&&o.state.isMatched?(o.textList.push({type:"sent",message:o.state.message,uuid:(0,b.Z)()}),o.setState((0,i.Z)((0,i.Z)({},o.state),{},{message:""})),o.state.Socket.emit("chat",{recepientId:o.state.recepientId,text:o.state.message}),o.forceUpdate(),o.scrollToBottom()):o.state.isMatched||o.setState((0,i.Z)((0,i.Z)({},o.state),{},{alertMsg:"You're not matched yet \nclick on match button to get matched",alertType:"warning"}))},o.receiveMessage=function(e){o.textList.push({type:"received",message:e.text,uuid:(0,b.Z)()}),o.forceUpdate(),o.scrollToBottom()},o.setEmojiVisibility=function(){o.setState((0,i.Z)((0,i.Z)({},o.state),{},{emojiVisible:!o.state.emojiVisible}))},o.addEmoji=function(e){o.setState((0,i.Z)((0,i.Z)({},o.state),{},{message:o.state.message+e.emoji}))},o.matchTimeup=function(){o.setState((0,i.Z)((0,i.Z)({},o.state),{},{matchRequested:!1,alertMsg:"Failed to find match, try again in sometime",alertType:"success"}))},o.state={message:"",redirect:o.props.authentication.name?void 0:"/",Socket:void 0,isMatched:o.props.SocConState.isMatched,recepientId:o.props.SocConState.recepientId,alertMsg:void 0,alertType:void 0,matchRequested:!1,mobileButtonVisible:!0,emojiVisible:!1,device:o.props.globalState.device},o.textList=[],o}return(0,o.Z)(s,[{key:"scrollToBottom",value:function(){setTimeout((function(e){document.getElementById("end").scrollIntoView({behavior:"smooth",block:"nearest"})}),0)}},{key:"componentDidMount",value:function(){var e=this;this.scrollToBottom(),this.props.authentication.name&&(new p.s).getSocket().then((function(t){t.on("chat",(function(t){e.receiveMessage(t)})),e.setState((0,i.Z)((0,i.Z)({},e.state),{},{Socket:t}))}))}},{key:"componentWillUnmount",value:function(){this.state.Socket&&this.state.Socket.disconnect(),window.sessionStorage.removeItem("recepientName"),window.sessionStorage.removeItem("recepientGender")}},{key:"render",value:function(){var e=this;return this.textList=this.props.SocConState.isMatched?this.textList:[],(0,T.jsxs)("div",{children:[(0,T.jsxs)("div",{className:" h-[100vh] flex flex-col",children:[(0,T.jsx)(l.Z,{}),(0,T.jsx)(I.Z,{}),this.state.redirect&&(0,T.jsx)(f.Fg,{to:this.state.redirect,replace:!0}),this.state.alertMsg&&(0,T.jsx)(v.Z,{text:this.state.alertMsg,callBack:function(){e.setState((0,i.Z)((0,i.Z)({},e.state),{},{alertMsg:void 0,alertType:void 0}))},type:this.state.alertType,timeOut:4e3}),(0,T.jsxs)("div",{className:"w-full h-[100%] flex",children:[(0,T.jsx)("div",{className:" w-[20%] h-[100%] mobile:hidden"}),(0,T.jsxs)("div",{className:" w-[60%] px-12 py-4 h-[100%] flex justify-center mobile:w-full mobile:p-0",children:[(0,T.jsxs)("div",{className:"w-1/3 flex flex-col justify-center mobile:hidden",children:[(0,T.jsxs)("button",{className:"w-40 h-10 flex p-2 justify-around my-2 rounded-full ".concat(this.state.isMatched?"bg-[#d7dbd6]":"bg-[#A7FB9A]","\n\t\t\t\t\t\t\ttext-sm hover:bg-[#8ef57e] hover:shadow-xl"),disabled:this.state.isMatched,onClick:this.requestMatch,children:[(0,T.jsx)("img",{width:"20px",src:h.Z}),this.state.matchRequested?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Z.Z,{size:4}),"desktop"==this.state.device?(0,T.jsx)(C.Z,{countdown:15,callback:this.matchTimeup}):void 0]}):"Match"]}),(0,T.jsxs)("button",{className:"w-40 h-10 flex p-2 justify-around rounded-full bg-[#FBB19A] text-sm hover:bg-[#f79b80] hover:shadow-lg",onClick:this.revokeMatch,children:[(0,T.jsx)("img",{width:"20px",src:r.Z}),"Disconnect"]})]}),(0,T.jsxs)("div",{className:"mobile:w-full mobile:h-full mobile:bg-white w-1/2 h-[88vh] px-2 py-3 bg-[#e6ebf98e] flex flex-col justify-between border ".concat(this.state.isMatched?"border-[#bfc2cc]":"border-[#f5bbaa]"," rounded-xl mobile:rounded-none"),children:[(0,T.jsxs)("div",{className:"bg-white h-10 flex justify-between p-2 rounded w-full shadow-md ",children:[(0,T.jsxs)("div",{className:"flex",children:[(0,T.jsx)("img",{className:"",src:m.Z,width:"16px"}),(0,T.jsx)("p",{className:"text-sm text-oxford_blue mt-auto mx-3",children:window.sessionStorage.getItem("recepientName")?window.sessionStorage.getItem("recepientName"):"User Name"})]}),(0,T.jsx)("img",{className:"",src:"Male"===window.sessionStorage.getItem("recepientGender")?j:"Female"===window.sessionStorage.getItem("recepientGender")?y:S,width:"20px"})]}),(0,T.jsx)("div",{className:"h-full w-full my-1 p-2 overflow-y-scroll scroll-none scroll-hide",children:this.textList.map((function(t,s){return s+1==e.textList.length?"sent"===t.type?(0,T.jsxs)("div",{id:"end",className:"w-2/3 h-fit bg-white float-right p-2 rounded my-1 rounded-tl-none shadow-sm text-xs",children:[" ",t.message]},t.uuid):(0,T.jsxs)("div",{id:"end",className:"w-2/3 h-fit bg-Primary-500 float-left p-2 my-1 rounded rounded-tl-none shadow-sm text-xs",children:[" ",t.message]},t.uuid):"sent"===t.type?(0,T.jsxs)("div",{className:"w-2/3 h-fit bg-white float-right p-2 rounded my-1 rounded-tl-none shadow-sm text-xs",children:[" ",t.message]},t.uuid):(0,T.jsxs)("div",{className:"w-2/3 h-fit bg-Primary-500 float-left p-2 my-1 rounded rounded-tl-none shadow-sm text-xs",children:[" ",t.message]},t.uuid)}))}),(0,T.jsxs)("div",{className:"hidden mobile:show w-full h-fit rounded-md bg-[#aaa8a850]",children:[(0,T.jsx)("div",{className:"w-full",onClick:function(){return e.setState((0,i.Z)((0,i.Z)({},e.state),{},{mobileButtonVisible:!e.state.mobileButtonVisible}))},children:(0,T.jsx)("img",{src:M.Z,className:"mx-auto bg-white rounded-b-md"})}),this.state.mobileButtonVisible&&(0,T.jsxs)("div",{className:"flex justify-around",children:[(0,T.jsx)("button",{className:"w-12 h-12 shadow flex p-2 justify-center items-center rounded-full ".concat(this.state.isMatched?"bg-[#d7dbd6]":"bg-[#A7FB9A]","\n\t\t\t\t\t\t\t\t\t\ttext-[8px] font-semibold hover:bg-[#8ef57e] hover:shadow-xl"),disabled:this.state.isMatched,onClick:this.requestMatch,children:this.state.matchRequested?(0,T.jsx)(Z.Z,{size:4}):"Connect"}),this.state.matchRequested&&"mobile"===this.state.device?(0,T.jsx)(C.Z,{countdown:15,callback:this.matchTimeup}):void 0,(0,T.jsx)("button",{className:"w-12 h-12 flex p-2 justify-center items-center rounded-full bg-[#FBB19A] text-[8px] hover:bg-[#f79b80] shadow-lg font-semibold",onClick:this.revokeMatch,children:"Disconnect"})]})]}),(0,T.jsxs)("div",{className:"bg-white border border-[#e5e7eb] h-14 min-h-[2.5rem] flex items-center px-2 rounded-full w-full cursor-pointer shadow-md hover:shadow-none",children:[(0,T.jsx)("div",{onClick:this.setEmojiVisibility,children:(0,T.jsx)("img",{className:"opacity-50",src:k})}),(0,T.jsx)("input",{value:this.state.message,onKeyDown:this.keyDown,onChange:function(t){return e.setState((0,i.Z)((0,i.Z)({},e.state),{},{message:t.target.value}))},maxLength:100,className:"outline-none rounded-full px-1 w-[100%]"}),(0,T.jsx)("div",{onClick:this.sendMessage,children:(0,T.jsx)("img",{src:u.Z})})]}),(0,T.jsx)("div",{style:{display:this.state.emojiVisible?"initial":"none"},className:"w-full h-1/2",children:(0,T.jsx)(N.ZP,{onEmojiClick:this.addEmoji,height:"100%",width:"100%",emojiStyle:"native",searchDisabled:!0})})]})]}),(0,T.jsx)("div",{className:" w-[20%] h-[100%] mobile:hidden"})]})]}),(0,T.jsx)(B.Z,{})]})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return(0,i.Z)((0,i.Z)({},t),{},{isMatched:e.SocConState.isMatched,recepientId:e.SocConState.recepientId,matchRequested:e.SocConState.isMatched?!e.SocConState.isMatched:t.matchRequested,device:e.globalState.device,alertMsg:e.SocConState.isMatched!=t.isMatched&&1==t.isMatched?"User disconnected":void 0,alertType:e.SocConState.isMatched!=t.isMatched&&1==t.isMatched?"warning":void 0})}}]),s}(d.Component);var R=(0,g.$j)((function(e){return(0,i.Z)({},e)}))(q)}}]);