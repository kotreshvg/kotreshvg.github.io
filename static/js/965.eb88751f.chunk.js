"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[965],{6965:function(e,t,s){s.r(t),s.d(t,{default:function(){return T}});var i=s(1413),a=s(5671),n=s(3144),o=s(136),c=s(7277),d=s(7313),l=s(7224),r=s(7185),h=s(6125),m=s(5034);var u=s.p+"static/media/sendicon.959c9c9a24b95e47529320c7bbbdd93c.svg",p=s(9864),x=s(8467),f=s(6446),g=s(3392),b=s(2549),v=s(1391),w=s(942),j=s(8933),y=s(6306),S=s(2658),Z=s(1577),M=s(4725);var k=s.p+"static/media/emojij.a0df3e98d05714551474a234c0e05ef6.svg",N=s(3936),C=s(4949),I=s(4319),q=s(6417),B=function(e){(0,o.Z)(s,e);var t=(0,c.Z)(s);function s(e){var n;return(0,a.Z)(this,s),(n=t.call(this,e)).keyDown=function(e){"Enter"===e.code&&(e.preventDefault(),n.sendMessage())},n.requestMatch=function(){console.log(n.state.device),n.state.matchRequested?n.setState((0,i.Z)((0,i.Z)({},n.state),{},{alertMsg:"Processing match request",alertType:"info"})):(n.setState((0,i.Z)((0,i.Z)({},n.state),{},{matchRequested:!0})),n.state.Socket.emit("MatchRequest",{mode:"chat",name:n.props.authentication.name,age:n.props.authentication.age,gender:n.props.authentication.gender}))},n.revokeMatch=function(){n.state.isMatched?(n.state.Socket.emit("MatchRevoked",{recepientId:n.state.recepientId}),n.textList=[],window.sessionStorage.removeItem("recepientName"),window.sessionStorage.removeItem("recepientGender"),p.Z.dispatch((0,w.c4)())):n.setState((0,i.Z)((0,i.Z)({},n.state),{},{alertMsg:"You're not connected",alertType:"warning"}))},n.sendMessage=function(){n.state.message.length>0&&n.state.isMatched?(n.textList.push({type:"sent",message:n.state.message,uuid:(0,b.Z)()}),n.setState((0,i.Z)((0,i.Z)({},n.state),{},{message:""})),n.state.Socket.emit("chat",{recepientId:n.state.recepientId,text:n.state.message}),n.forceUpdate()):n.state.isMatched||n.setState((0,i.Z)((0,i.Z)({},n.state),{},{alertMsg:"You're not matched yet \nclick on match button to get matched",alertType:"warning"}))},n.receiveMessage=function(e){n.textList.push({type:"received",message:e.text,uuid:(0,b.Z)()}),n.forceUpdate()},n.setEmojiVisibility=function(){n.setState((0,i.Z)((0,i.Z)({},n.state),{},{emojiVisible:!n.state.emojiVisible}))},n.addEmoji=function(e){n.setState((0,i.Z)((0,i.Z)({},n.state),{},{message:n.state.message+e.emoji}))},n.matchTimeup=function(){n.setState((0,i.Z)((0,i.Z)({},n.state),{},{matchRequested:!1,alertMsg:"Failed to find match, try again in sometime",alertType:"success"}))},n.state={message:"",redirect:n.props.authentication.name?void 0:"/",Socket:void 0,isMatched:n.props.SocConState.isMatched,recepientId:n.props.SocConState.recepientId,alertMsg:void 0,alertType:void 0,matchRequested:!1,mobileButtonVisible:!0,emojiVisible:!1,device:n.props.globalState.device},n.textList=[],n}return(0,n.Z)(s,[{key:"scrollToBottom",value:function(){document.getElementById("end").scrollIntoView({behavior:"smooth"})}},{key:"componentDidMount",value:function(){var e=this;this.scrollToBottom(),this.props.authentication.name&&(new f.s).getSocket().then((function(t){t.on("chat",(function(t){e.receiveMessage(t)})),e.setState((0,i.Z)((0,i.Z)({},e.state),{},{Socket:t}))}))}},{key:"componentWillUnmount",value:function(){this.state.Socket&&this.state.Socket.disconnect(),window.sessionStorage.removeItem("recepientName"),window.sessionStorage.removeItem("recepientGender")}},{key:"render",value:function(){var e=this;return this.textList=this.props.SocConState.isMatched?this.textList:[],(0,q.jsxs)("div",{className:" h-[100vh] flex flex-col",children:[(0,q.jsx)(l.Z,{}),(0,q.jsx)(I.Z,{}),this.state.redirect&&(0,q.jsx)(x.Fg,{to:this.state.redirect,replace:!0}),this.state.alertMsg&&(0,q.jsx)(v.Z,{text:this.state.alertMsg,callBack:function(){e.setState((0,i.Z)((0,i.Z)({},e.state),{},{alertMsg:void 0,alertType:void 0}))},type:this.state.alertType,timeOut:4e3}),(0,q.jsxs)("div",{className:"w-full h-[100%] flex",children:[(0,q.jsx)("div",{className:" w-[20%] h-[100%] mobile:hidden"}),(0,q.jsxs)("div",{className:" w-[60%] px-12 py-4 h-[100%] flex justify-center mobile:w-full mobile:p-0",children:[(0,q.jsxs)("div",{className:"w-1/3 flex flex-col justify-center mobile:hidden",children:[(0,q.jsxs)("button",{className:"w-40 h-10 flex p-2 justify-around my-2 rounded-full ".concat(this.state.isMatched?"bg-[#d7dbd6]":"bg-[#A7FB9A]","\n\t\t\t\t\t\t\ttext-sm hover:bg-[#8ef57e] hover:shadow-xl"),disabled:this.state.isMatched,onClick:this.requestMatch,children:[(0,q.jsx)("img",{width:"20px",src:h.Z}),this.state.matchRequested?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Z.Z,{size:4}),"desktop"==this.state.device?(0,q.jsx)(C.Z,{countdown:15,callback:this.matchTimeup}):void 0]}):"Match"]}),(0,q.jsxs)("button",{className:"w-40 h-10 flex p-2 justify-around rounded-full bg-[#FBB19A] text-sm hover:bg-[#f79b80] hover:shadow-lg",onClick:this.revokeMatch,children:[(0,q.jsx)("img",{width:"20px",src:r.Z}),"Disconnect"]})]}),(0,q.jsxs)("div",{className:"mobile:w-full mobile:h-full mobile:bg-white w-1/2 h-[88vh] px-2 py-3 bg-[#e6ebf98e] flex flex-col justify-between border ".concat(this.state.isMatched?"border-[#bfc2cc]":"border-[#f5bbaa]"," rounded-xl mobile:rounded-none"),children:[(0,q.jsxs)("div",{className:"bg-white h-10 flex justify-between p-2 rounded w-full shadow-md ",children:[(0,q.jsxs)("div",{className:"flex",children:[(0,q.jsx)("img",{className:"",src:m.Z,width:"16px"}),(0,q.jsx)("p",{className:"text-sm text-oxford_blue mt-auto mx-3",children:window.sessionStorage.getItem("recepientName")?window.sessionStorage.getItem("recepientName"):"User Name"})]}),(0,q.jsx)("img",{className:"",src:"Male"===window.sessionStorage.getItem("recepientGender")?j:"Female"===window.sessionStorage.getItem("recepientGender")?y:S,width:"20px"})]}),(0,q.jsxs)("div",{className:"h-full w-full my-1 p-2 overflow-y-scroll scroll-none scroll-hide",children:[this.textList.map((function(e){return"sent"===e.type?(0,q.jsxs)("div",{className:"w-2/3 h-fit bg-white float-right p-2 rounded my-1 rounded-tl-none shadow-sm text-xs",children:[" ",e.message]},e.uuid):(0,q.jsxs)("div",{className:"w-2/3 h-fit bg-Primary-500 float-left p-2 my-1 rounded rounded-tl-none shadow-sm text-xs",children:[" ",e.message]},e.uuid)})),(0,q.jsx)("div",{id:"end"})]}),(0,q.jsxs)("div",{className:"hidden mobile:show w-full h-fit rounded-md bg-[#aaa8a850]",children:[(0,q.jsx)("div",{className:"w-full",onClick:function(){return e.setState((0,i.Z)((0,i.Z)({},e.state),{},{mobileButtonVisible:!e.state.mobileButtonVisible}))},children:(0,q.jsx)("img",{src:M.Z,className:"mx-auto bg-white rounded-b-md"})}),this.state.mobileButtonVisible&&(0,q.jsxs)("div",{className:"flex justify-around",children:[(0,q.jsx)("button",{className:"w-12 h-12 shadow flex p-2 justify-center items-center rounded-full ".concat(this.state.isMatched?"bg-[#d7dbd6]":"bg-[#A7FB9A]","\n\t\t\t\t\t\t\t\t\t\ttext-[8px] font-semibold hover:bg-[#8ef57e] hover:shadow-xl"),disabled:this.state.isMatched,onClick:this.requestMatch,children:this.state.matchRequested?(0,q.jsx)(Z.Z,{size:4}):"Connect"}),this.state.matchRequested&&"mobile"===this.state.device?(0,q.jsx)(C.Z,{countdown:15,callback:this.matchTimeup}):void 0,(0,q.jsx)("button",{className:"w-12 h-12 flex p-2 justify-center items-center rounded-full bg-[#FBB19A] text-[8px] hover:bg-[#f79b80] shadow-lg font-semibold",onClick:this.revokeMatch,children:"Disconnect"})]})]}),(0,q.jsxs)("div",{className:"bg-white border border-[#e5e7eb] h-14 flex items-center px-2 rounded-full w-full cursor-pointer shadow-md hover:shadow-none",children:[(0,q.jsx)("div",{onClick:this.setEmojiVisibility,children:(0,q.jsx)("img",{className:"opacity-50",src:k})}),(0,q.jsx)("input",{value:this.state.message,onKeyDown:this.keyDown,onChange:function(t){return e.setState((0,i.Z)((0,i.Z)({},e.state),{},{message:t.target.value}))},maxLength:100,className:"outline-none rounded-full px-1 w-[100%]"}),(0,q.jsx)("div",{onClick:this.sendMessage,children:(0,q.jsx)("img",{src:u})})]}),(0,q.jsx)("div",{style:{display:this.state.emojiVisible?"initial":"none"},className:"w-full h-1/2",children:(0,q.jsx)(N.ZP,{onEmojiClick:this.addEmoji,height:"100%",width:"100%",emojiStyle:"native",searchDisabled:!0})})]})]}),(0,q.jsx)("div",{className:" w-[20%] h-[100%] mobile:hidden"})]})]})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return(0,i.Z)((0,i.Z)({},t),{},{isMatched:e.SocConState.isMatched,recepientId:e.SocConState.recepientId,matchRequested:e.SocConState.isMatched?!e.SocConState.isMatched:t.matchRequested,device:e.globalState.device})}}]),s}(d.Component);var T=(0,g.$j)((function(e){return(0,i.Z)({},e)}))(B)}}]);